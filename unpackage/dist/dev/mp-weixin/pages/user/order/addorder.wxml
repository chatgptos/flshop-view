<view><view class="edgeInsetTop"></view><view class="wanl-order"><view class="address cu-list menu-avatar margin-bj radius-bock"><view class="cu-item"><view class="cu-avatar round wanl-bg-orange"><text class="wlIcon-weizhi1"></text></view><block wx:if="{{addressData.address}}"><view data-event-opts="{{[['tap',[['userAddress']]]]}}" class="content" bindtap="__e"><view><text class="wanl-pip margin-right-sm">{{addressData.name}}</text><text class="wanl-gray-light text-sm">{{addressData.mobile}}</text></view><view class="text-sm wanl-pip text-cut">{{addressData.province+" "+addressData.city+" "+addressData.district+" "+addressData.address}}</view></view></block><block wx:else><view data-event-opts="{{[['tap',[['addAddress',['newadd']]]]]}}" class="content" bindtap="__e"><view class="text-sm wanl-pip text-cut">点击此处填写收货地址</view></view></block><view class="action"><text class="wlIcon-fanhui2 text-lg"></text></view></view></view><block wx:for="{{$root.l1}}" wx:for-item="shop" wx:for-index="index" wx:key="index"><view class="lists bg-white margin-bj radius-bock"><view class="shopname"><text class="wlIcon-dianpu2 text-orange margin-right-sm"></text><text class="wanl-pip text-df">{{shop.$orig.shop_name}}</text></view><view class="cu-list menu-avatar"><block wx:for="{{shop.l0}}" wx:for-item="goods" wx:for-index="key" wx:key="key"><view class="cu-item margin-bottom"><view class="cu-avatar radius-bock" style="{{'background-image:'+('url('+goods.g0+')')+';'}}"></view><view class="content"><view class="text-sm text-cut-2">{{goods.$orig.title}}</view><view class="wanl_sku text-sm"><block wx:for="{{goods.$orig.sku.difference}}" wx:for-item="item" wx:for-index="skey" wx:key="skey"><text><block wx:if="{{skey!=0}}"><block>-</block></block>{{item+''}}</text></block></view></view><view class="action"><view class="wanl-pip text-sm text-price">{{goods.$orig.sku.price}}</view><view class="wanl-gray-light text-sm">{{"x"+goods.$orig.number}}</view></view></view></block></view><form><view class="cu-form-group"><view class="wanl-gray-light title">快递运费</view><view class="picker">{{shop.$orig.freight.name+''}}<text class="text-price margin-left-xs">{{shop.$orig.freight.price}}</text></view></view><view data-event-opts="{{[['tap',[['queryCoupon',[index]]]]]}}" class="cu-form-group" bindtap="__e"><view class="wanl-gray-light title">优惠折扣</view><view class="picker"><block wx:if="{{couponData[index]}}"><block><text class="wlIcon-youhuiquantuangou text-red margin-right-xs"></text><block wx:if="{{couponData[index].type=='reduction'||couponData[index].type=='vip'&&couponData[index].usertype=='reduction'}}"><block><text>{{"满"+shop.m0+"减"}}</text>{{'￥'+shop.m1+''}}</block></block><block wx:if="{{couponData[index].type=='discount'||couponData[index].type=='vip'&&couponData[index].usertype=='discount'}}"><block><text>{{"满"+shop.m2+"打"}}</text>{{''+shop.m3+' 折'}}</block></block><block wx:if="{{couponData[index].type=='shipping'}}"><block><text>{{"满"+shop.m4}}</text>包邮</block></block></block></block><block wx:else><block><text class="text-gray">请选择</text></block></block><text class="wlIcon-fanhui2 margin-left"></text></view></view><view class="cu-form-group align-start"><view class="wanl-gray-light title">备注</view><textarea maxlength="-1" placeholder="订单备注可选" data-event-opts="{{[['input',[['__set_model',['$0','remarks','$event',[]],[[['orderData.lists','',index]]]]]]]}}" value="{{shop.$orig.remarks}}" bindinput="__e"></textarea></view></form><view class="text-right margin-bj text-sm"><text class="wanl-gray">{{"共"+shop.$orig.number+"件，"}}</text>小计：<text class="text-price text-orange">{{shop.$orig.sub_price}}</text></view></view></block><view class="safeAreaBottom"></view><view data-event-opts="{{[['touchmove',[['moveHandle',['$event']]]]]}}" class="WANL-MODAL text-sm" catchtouchmove="__e"><view data-event-opts="{{[['tap',[['hideModal',['$event']]]]]}}" class="{{['cu-modal','bottom-modal',modalName=='coupon'?'show':'']}}" bindtap="__e"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="cu-dialog bg-bgcolor" catchtap="__e"><view class="wanl-modal"><view class="head padding-bj"><view class="content"><view class="text-lg">优惠券</view></view><view data-event-opts="{{[['tap',[['hideModal',['$event']]]]]}}" class="close wlIcon-31guanbi" bindtap="__e"></view></view><block wx:if="{{couponIndex!=null}}"><scroll-view class="wanl-coupon scroll-y" scroll-y="true"><block wx:for="{{$root.l2}}" wx:for-item="coupon" wx:for-index="index" wx:key="index"><view class="{{['item','margin-bottom-bj','radius-bock',coupon.$orig.type]}}"><image class="coupon-bg" src="{{$root.g1}}"></image><block wx:if="{{coupon.$orig.state}}"><image class="coupon-sign" src="{{coupon.g2}}"></image></block><view class="item-left"><block wx:if="{{coupon.$orig.type=='reduction'||coupon.$orig.type=='vip'&&coupon.$orig.usertype=='reduction'}}"><block><view class="colour"><text class="text-price"></text><text class="prices">{{coupon.m5}}</text></view><view class="cu-tag wanl-gray-dark radius text-sm bg-white">{{'满'+coupon.m6+"减"+coupon.m7+''}}</view></block></block><block wx:if="{{coupon.$orig.type=='discount'||coupon.$orig.type=='vip'&&coupon.$orig.usertype=='discount'}}"><block><view class="colour"><text class="prices">{{coupon.m8}}</text><text class="discount">折</text></view><view class="cu-tag wanl-gray-dark radius text-sm bg-white">{{'满'+coupon.m9+"打"+coupon.m10+'折'}}</view></block></block><block wx:if="{{coupon.$orig.type=='shipping'}}"><block><view class="colour"><text class="prices">包邮</text></view><view class="cu-tag wanl-gray-dark radius text-sm bg-white">{{'满'+coupon.m11+'元包邮'}}</view></block></block></view><view class="item-right padding-bj"><view class="title"><view class="cu-tag sm radius margin-right-xs tagstyle">{{''+coupon.$orig.type_text+''}}</view><text class="text-cut wanl-gray text-min">{{coupon.$orig.name}}</text></view><view class="content text-min"><view class="wanl-gray"><block wx:if="{{coupon.$orig.grant!='-1'}}"><view><text class="wlIcon-dot"></text>{{"目前仅剩余 "+coupon.$orig.surplus+' 张'}}</view></block><block wx:if="{{coupon.$orig.drawlimit!=0}}"><view><text class="wlIcon-dot"></text>{{"每人仅限领取 "+coupon.$orig.drawlimit+' 张'}}</view></block><block wx:if="{{coupon.$orig.pretype=='fixed'}}"><block><view><text class="wlIcon-dot"></text>{{"生效 "+coupon.$orig.startdate+''}}</view><view><text class="wlIcon-dot"></text>{{"结束 "+coupon.$orig.enddate+''}}</view></block></block><block wx:if="{{coupon.$orig.pretype=='appoint'}}"><block><block wx:if="{{coupon.$orig.validity==0}}"><view><text class="wlIcon-dot"></text>未使用前 永久 有效</view></block><block wx:else><view><text class="wlIcon-dot"></text>{{"领取后 "+coupon.$orig.validity+' 天有效'}}</view></block></block></block></view><block wx:if="{{coupon.$orig.state}}"><view data-event-opts="{{[['tap',[['onCoupons',[index]]]]]}}" class="cu-btn sm round line-colour" bindtap="__e"><block wx:if="{{coupon.$orig.choice}}"><text>已选择</text></block><block wx:else><text>立即使用</text></block></view></block><block wx:else><view data-event-opts="{{[['tap',[['onReceive',[index]]]]]}}" class="cu-btn sm round" bindtap="__e">立即领取</view></block></view></view></view></block></scroll-view></block><view class="foot padding-lr-bj"><button data-event-opts="{{[['tap',[['hideModal',['$event']]]]]}}" class="cu-btn bg-gradual-orange round text-bold complete" bindtap="__e">完成</button></view></view></view></view></view><view class="wanlian cu-bar tabbar solid-top foot text-df"><view><text class="wanl-gray">{{"共"+orderData.statis.allnum+"件，"}}</text>合计：<text class="text-price text-orange">{{orderData.statis.allsub}}</text></view><block wx:if="{{loading}}"><button class="cu-btn round lg bg-gradual-orange margin-lr-bj"><text class="wlIcon-jiazai wlIconfont-spin margin-right-xs"></text>提交中...</button></block><block wx:else><button data-event-opts="{{[['tap',[['addOrder',['$event']]]]]}}" class="cu-btn round lg bg-gradual-orange margin-lr-bj" bindtap="__e">提交订单</button></block></view></view></view>