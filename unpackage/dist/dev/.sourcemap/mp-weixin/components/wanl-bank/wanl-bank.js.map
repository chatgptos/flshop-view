{"version":3,"sources":["webpack:///D:/soft/fenglei/code/flshop/components/wanl-bank/wanl-bank.vue?14bf","webpack:///D:/soft/fenglei/code/flshop/components/wanl-bank/wanl-bank.vue?d25e","webpack:///D:/soft/fenglei/code/flshop/components/wanl-bank/wanl-bank.vue?fff6","webpack:///D:/soft/fenglei/code/flshop/components/wanl-bank/wanl-bank.vue?5e0d","uni-app:///components/wanl-bank/wanl-bank.vue","webpack:///D:/soft/fenglei/code/flshop/components/wanl-bank/wanl-bank.vue?dbcf","webpack:///D:/soft/fenglei/code/flshop/components/wanl-bank/wanl-bank.vue?ae76"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsH;AACtH;AAC6D;AACL;AACa;;;AAGrE;AACmK;AACnK,gBAAgB,0KAAU;AAC1B,EAAE,+EAAM;AACR,EAAE,oFAAM;AACR,EAAE,6FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,wFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAsmB,CAAgB,omBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC0B1nB;AACA,kBADA;AAEA;AACA,8CADA;AAEA,8CAFA;AAGA,8CAHA;AAIA,8CAJA,EAFA;;AAQA;AACA,aADA,uBACA;AACA;AACA,KAHA;AAIA,aAJA,uBAIA;AACA;AACA;AACA,KAPA,EARA;;AAiBA,MAjBA,kBAiBA;;;;;;AAMA;AACA,kBADA;AAEA,eAFA;AAGA,sBAHA;;AAKA,sBALA;;;;;;AAWA,GAlCA;AAmCA;AACA,aADA,uBACA;AACA;;AAEA,oFAHA;;AAKA,sCALA;AAMA,yCANA;AAOA,KARA;AASA,gBATA,0BASA;AACA,gEADA;AAEA,sBAFA,GAEA,eAFA;AAGA,wBAHA,GAGA,cAHA;AAIA;AACA;AACA;AACA;AACA;AACA,uBATA,GASA,UATA;AAUA;AACA;AACA;AACA,yBAbA,GAaA,yBAbA;AAcA,qGAdA;AAeA,iDAfA;AAgBA,0DAhBA,UAgBA,SAhBA;AAiBA,mDAjBA;AAkBA,KA3BA;AA4BA,oBA5BA,4BA4BA,SA5BA,EA4BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA,OANA;AAOA;AACA;AACA;AACA;AACA;AACA,OALA,EAKA,IALA,CAKA,IALA;AAMA;AACA;AACA,KAxDA;AAyDA,gBAzDA,wBAyDA,KAzDA,EAyDA,IAzDA,EAyDA;AACA;AACA;AACA,+BADA;AAEA,kBAFA;AAGA,kBAHA;AAIA,qBAJA;AAKA,sBALA;AAMA,iBANA,mBAMA,GANA,EAMA;AACA;AACA,WARA;AASA,cATA,gBASA,GATA,EASA;AACA;AACA;AACA,WAZA;;AAcA,cAdA;;AAgBA,OAjBA;AAkBA,KA5EA;AA6EA,eA7EA,yBA6EA;AACA;AACA;AACA,+EADA;AAEA,iBAFA,mBAEA,GAFA,EAEA;AACA;AACA,WAJA;AAKA,cALA,gBAKA,GALA,EAKA;AACA;AACA;AACA,WARA;;AAUA,OAXA;AAYA,KA1FA;AA2FA,QA3FA,gBA2FA,OA3FA,EA2FA;AACA;AACA;AACA;AACA,SAFA;AAGA,OAJA;AAKA,KAjGA,EAnCA;;AAsIA,SAtIA,qBAsIA;AACA;AACA;AACA,KAFA;AAGA,GA1IA,E;;;;;;;;;;;;;AC1BA;AAAA;AAAA;AAAA;AAAy3B,CAAgB,m1BAAG,EAAC,C;;;;;;;;;;;ACA74B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/wanl-bank/wanl-bank.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./wanl-bank.vue?vue&type=template&id=4d53e0c8&\"\nvar renderjs\nimport script from \"./wanl-bank.vue?vue&type=script&lang=js&\"\nexport * from \"./wanl-bank.vue?vue&type=script&lang=js&\"\nimport style0 from \"./wanl-bank.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/wanl-bank/wanl-bank.vue\"\nexport default component.exports","export * from \"-!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./wanl-bank.vue?vue&type=template&id=4d53e0c8&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../hbuild/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./wanl-bank.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../hbuild/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./wanl-bank.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"bank-item\" :style=\"bankThem\">\r\n\t\t<!-- #ifndef MP -->\r\n\t\t<canvas v-if=\"showCanvas\" class=\"bank-icon\" :id=\"uuid\" :canvas-id=\"uuid\" />\r\n\t\t<!-- #endif -->\r\n\t\t<!-- #ifdef MP -->\r\n\t\t<canvas v-if=\"showCanvas\" class=\"bank-icon\" id=\"bankIcon\" canvas-id=\"bankIcon\" />\r\n\t\t<!-- #endif -->\r\n\t\t<view class=\"bank-head\">\r\n\t\t\t<image :src=\"image\"></image>\r\n\t\t\t<view class=\"bank-info\">\r\n\t\t\t\t<text class=\"bank-name\">{{bankName}}</text>\r\n\t\t\t\t<text class=\"card-type\">{{cardType}}</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"card-code\">\r\n\t\t\t<text class=\"omit\">****</text>\r\n\t\t\t<text class=\"omit\">****</text>\r\n\t\t\t<text class=\"omit\">****</text>\r\n\t\t\t<text>{{endNumber}}</text>\r\n\t\t</view>\r\n\t\t<image class=\"bank-watermark\" :src=\"waterMark\"></image>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\tname: 'wanlBank',\r\n\t\tprops: {\r\n\t\t\tbankCode: { type: String, required: true},\r\n\t\t\tbankName: { type: String, required: true},\r\n\t\t\tcardType: { type: String, default: '储蓄卡' },\r\n\t\t\tcardCode: { type: String, required: true}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\twaterMark() {\r\n\t\t\t\treturn this.image;\r\n\t\t\t},\r\n\t\t\tendNumber() {\r\n\t\t\t\tlet length = this.cardCode.length;\r\n\t\t\t\treturn this.cardCode.substr(length - 4, length);\r\n\t\t\t}\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\t// #ifndef MP\r\n\t\t\tconst buildUuid = () => {\r\n\t\t\t\treturn 'bank_' + parseInt(Math.random() * 100000000);\r\n\t\t\t};\r\n\t\t\t// #endif\r\n\t\t\treturn {\r\n\t\t\t\tbankThem: '',\r\n\t\t\t\timage: '',\r\n\t\t\t\tshowCanvas: true,\r\n\t\t\t\t// #ifdef MP\r\n\t\t\t\tuuid: 'bankIcon',\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifndef MP\r\n\t\t\t\tuuid: buildUuid()\r\n\t\t\t\t// #endif\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tasync buildItem() {\r\n\t\t\t\tthis.bankThem = uni.getStorageSync(`BANK_${this.bankCode}`);\r\n\t\t\t\t\r\n\t\t\t\tthis.image = `/static/images/bank/${this.bankCode}.png`;\r\n\t\t\t\t\r\n\t\t\t\tawait this.getThemColor();\r\n\t\t\t\tthis.showCanvas = false;\r\n\t\t\t},\r\n\t\t\tasync getThemColor() {\r\n\t\t\t\tif(this.bankThem != null && this.bankThem != '') return;\r\n\t\t\t\tlet bgSize = uni.upx2px(100);\r\n\t\t\t\tlet iconSize = uni.upx2px(72);\r\n\t\t\t\tthis.iconContext = uni.createCanvasContext(this.uuid, this);\r\n\t\t\t\tthis.iconContext.width = bgSize;\r\n\t\t\t\tthis.iconContext.height = bgSize;\r\n\t\t\t\tthis.iconContext.fillStyle = '#FFFFFF';\r\n\t\t\t\tthis.iconContext.beginPath();\r\n\t\t\t\tlet bgRadio = bgSize / 2;\r\n\t\t\t\tthis.iconContext.arc(bgRadio, bgRadio, bgRadio - 1 , 0, 2 * Math.PI, 0, true);\r\n\t\t\t\tthis.iconContext.closePath();\r\n\t\t\t\tthis.iconContext.fill();\r\n\t\t\t\tlet iconRadio =  bgSize / 2 - iconSize / 2;\r\n\t\t\t\tthis.iconContext.drawImage(this.image, iconRadio, iconRadio, iconSize, iconSize);\r\n\t\t\t\tawait this.draw(this.iconContext);\r\n\t\t\t\tlet imageData = await this.getImageData(iconRadio, iconSize);\r\n\t\t\t\tthis.parsingImageData(imageData);\r\n\t\t\t},\r\n\t\t\tparsingImageData(imageData) {\r\n\t\t\t\tlet statistics = {};\r\n\t\t\t\tfor (let i = 0, length = imageData.length; i < length; i += 4) {\r\n\t\t\t\t\tlet r = imageData[i];\r\n\t\t\t\t\tlet g = imageData[i + 1];\r\n\t\t\t\t\tlet b = imageData[i + 2];\r\n\t\t\t\t\tif((r + g + b) < 400) {\r\n\t\t\t\t\t\tlet rgb = [r, g, b];\r\n\t\t\t\t\t\tlet key = rgb.join(', ');\r\n\t\t\t\t\t\tstatistics[key] = statistics[key] == null ? 1 : statistics[key] + 1;\r\n\t\t\t\t\t}\t\r\n\t\t\t\t}\r\n\t\t\t\tlet maxKey = '';\r\n\t\t\t\tObject.keys(statistics).forEach(key => {\r\n\t\t\t\t\tif (maxKey === '') {\r\n\t\t\t\t\t\tmaxKey = key;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmaxKey = statistics[maxKey] > statistics[key] ? maxKey : key;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tlet beginColor =  maxKey.split(', ').map((item, index) => {\r\n\t\t\t\t\titem = parseInt(item);\r\n\t\t\t\t\tif(index > 1) return item;\r\n\t\t\t\t\tlet newColor = item + 50;\r\n\t\t\t\t\treturn newColor > 255 ? 255 : newColor;\r\n\t\t\t\t}).join(', ');\r\n\t\t\t\tthis.bankThem = `background-image: linear-gradient(45deg, rgba(${beginColor}, 1), rgba(${maxKey}, 1));`;\r\n\t\t\t\tuni.setStorageSync(`BANK_${this.bankCode}`, this.bankThem);\r\n\t\t\t},\r\n\t\t\tgetImageData(radio, size) {\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\tuni.canvasGetImageData({\r\n\t\t\t\t\t\t\tcanvasId: this.uuid,\r\n\t\t\t\t\t\t\tx: radio,\r\n\t\t\t\t\t\t\ty: radio,\r\n\t\t\t\t\t\t\twidth: size,\r\n\t\t\t\t\t\t\theight: size,\r\n\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\tresolve(res.data);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t\t\t\treject();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tthis\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tgetBankLogo() {\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\tuni.downloadFile({\r\n\t\t\t\t\t\turl: this.$flbooth.appstc(`/bank/${this.bankCode}.png`),\r\n\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\tresolve(res.tempFilePath);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t\t\treject();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tdraw(context, reserve = false) {\r\n\t\t\t\treturn new Promise((resolve) => {\r\n\t\t\t\t\tcontext.draw(reserve, () => {\r\n\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.$nextTick(() => {\r\n\t\t\t\tthis.buildItem();\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style>\r\n\t.omit {\r\n\t\tfont-size: 48rpx;\r\n\t\tmargin-right: 30rpx;\r\n\t}\r\n\t.card-code {\r\n\t\tmargin-top: 15rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: flex-end;\r\n\t\tcolor: #FFFFFF;\r\n\t\tfont-size: 38rpx;\r\n\t\t\r\n\t}\r\n\t.flex-1 {\r\n\t\tflex: 1;\r\n\t}\r\n\t.card-type {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #F1F1F1;\r\n\t}\r\n\t.bank-name {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #FFFFFF;\r\n\t}\r\n\t.bank-info {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tmargin-left: 30rpx;\r\n\t}\r\n\t.bank-head {\r\n\t\tdisplay: flex;\r\n\t\tflex: 1;\r\n\t\talign-items: center;\r\n\t}\r\n\t.bank-head image {\r\n\t\twidth: 100rpx;\r\n\t\theight: 100rpx;\r\n\t\tpadding: 15rpx;\r\n\t\tbackground-color: #FFFFFF;\r\n\t\tborder-radius: 50%;\r\n\t\toverflow: hidden;\r\n\t}\r\n\t.bank-icon {\r\n\t\tposition: absolute;\r\n\t\ttop: 20rpx;\r\n\t\tleft: 20rpx;\r\n\t\twidth: 100rpx;\r\n\t\theight: 100rpx;\r\n\t}\r\n\r\n\t.bank-watermark {\r\n\t\tposition: absolute;\r\n\t\tright: 60rpx;\r\n\t\tbottom: -30rpx;\r\n\t\twidth: 120rpx;\r\n\t\theight: 120rpx;\r\n\t\tfilter: grayscale(100%) brightness(400%);\r\n\t\topacity: 0.1;\r\n\t}\r\n\r\n\t.bank-item {\r\n\t\tflex: 1;\r\n\t\tmargin-top: 20rpx;\r\n\t\tposition: relative;\r\n\t\tborder-radius: 20rpx;\r\n\t\tpadding: 20rpx;\r\n\t}\r\n\t\r\n\t/* .bank-item:after {\r\n\t\tcontent: \"\";\r\n\t\tdisplay: block;\r\n\t\tbackground: inherit;\r\n\t\tfilter: blur(10rpx);\r\n\t\tposition: absolute;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\ttop: 10rpx;\r\n\t\tleft: 10rpx;\r\n\t\tz-index: -1;\r\n\t\topacity: 0.4;\r\n\t\ttransform-origin: 0 0;\r\n\t\tborder-radius: inherit;\r\n\t\ttransform: scale(1, 1);\r\n\t} */\r\n</style>\r\n","import mod from \"-!../../../../../hbuild/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../hbuild/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../hbuild/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./wanl-bank.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../hbuild/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../hbuild/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../hbuild/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../hbuild/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./wanl-bank.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1657175327381\n      var cssReload = require(\"D:/soft/hbuild/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}