(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/auth/auth"],{7511:function(t,e,o){"use strict";var n;o.d(e,"b",(function(){return c})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){return n}));var c=function(){var t=this,e=t.$createElement;t._self._c},i=[]},"7a7c":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=c(o("7d5f"));function c(t){return t&&t.__esModule?t:{default:t}}var i={data:function(){return{submitDisabled:!0,providerList:[],loginRes:{},pageroute:"",checked:0}},onLoad:function(e){var o=this,n=this.$flbooth.prePage().$mp.page;this.pageroute=encodeURIComponent("/".concat(n.route,"?").concat(this.queryParams(n.options))),t.getProvider({service:"oauth",success:function(t){o.providerList=t.provider.map((function(t){var e="",o="";switch(t){case"weixin":e="wlIcon-WeChat",o="mp_weixin";break;case"qq":e="wlIcon-QQ",o="mp_qq";break;case"sinaweibo":e="wlIcon-WeiBo",o="app_weibo";break;case"xiaomi":e="wlIcon-Xiaomi",o="app_xiaomi";break;case"apple":e="wlIcon-Apple",o="apple";break}return{id:t,name:e,platform:o}}))},fail:function(t){console.log("获取登录通道失败",t)}}),t.login({provider:"weixin",success:function(t){o.loginRes=t},fail:function(t){o.$flbooth.msg(t.msg)}})},methods:{CheckboxChange:function(t){this.checked=t.detail.value},tologin:function(e){var o=this;t.showLoading({title:"登录中"}),t.login({provider:e.id,success:function(n){o.$api.post({url:"/flbooth/user/third",data:{platform:e.platform,loginData:n,client_id:t.getStorageSync("flbooth:chat_client_id")?t.getStorageSync("flbooth:chat_client_id"):null},success:function(n){t.hideLoading(),0==n.binding?o.$flbooth.to("/pages/user/auth/perfect?token=".concat(n.token,"&platform=").concat(e.platform,"&url=").concat(o.pageroute)):(o.$store.dispatch("user/login",n),o.$store.dispatch("cart/login"),o.$store.dispatch("chat/get"),t.reLaunch({url:decodeURIComponent(o.pageroute)}))}}),t.hideKeyboard()},fail:function(t){o.$flbooth.msg(t.msg)}})},onKeyInput:function(t){this.submitDisabled=!1},decryptPhoneNumber:function(e){var o=this;"getPhoneNumber:fail user deny"!=e.detail.errMsg&&this.$api.post({url:"/flbooth/user/phone",data:{encryptedData:e.detail.encryptedData,iv:e.detail.iv,code:this.loginRes.code,client_id:t.getStorageSync("flbooth:chat_client_id")?t.getStorageSync("flbooth:chat_client_id"):null},success:function(e){o.$store.dispatch("user/login",e),o.$store.dispatch("cart/login"),t.reLaunch({url:decodeURIComponent(o.pageroute)})}})},formSubmit:function(e){var o=this;if(2==this.checked){var c=[{name:"account",checkType:"phoneno",errorMsg:"不是手机号码"}],i=e.detail.value,a=n.default.check(i,c);a?this.$api.get({url:"/flbooth/validate/check_mobile_exist",data:{mobile:i.account},success:function(t){o.$flbooth.to("phone?mobile=".concat(i.account,"&url=").concat(o.pageroute),"none")},fail:function(e){t.showModal({title:"提示",content:"账号不存在，是否注册？",success:function(t){t.confirm?o.$flbooth.to("register?mobile=".concat(i.account,"&url=").concat(o.pageroute)):t.cancel&&console.log("取消")}})}}):i.account?this.$flbooth.to("name?name=".concat(i.account,"&url=").concat(this.pageroute),"none"):this.$flbooth.msg("请填写账号")}else this.checked=1,setTimeout((function(){o.checked=0,o.$flbooth.msg("请先同意用户协议和隐私保护声明")}),300)},getUrlCode:function(){var t=location.search,e=new Object;if(-1!=t.indexOf("?"))for(var o=t.substr(1),n=o.split("&"),c=0;c<n.length;c++)e[n[c].split("=")[0]]=n[c].split("=")[1];return e},register:function(){this.$flbooth.to("register?url=".concat(this.pageroute))},help:function(){this.$flbooth.to("/pages/user/help?url=".concat(this.pageroute))},queryParams:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=e?"?":"",n=[],c=function(e){var o=t[e];if(["",void 0,null].includes(o))return"continue";o.constructor===Array?o.forEach((function(t){n.push(encodeURIComponent(e)+"[]="+encodeURIComponent(t))})):n.push(encodeURIComponent(e)+"="+encodeURIComponent(o))};for(var i in t)c(i);return n.length?o+n.join("&"):""}}};e.default=i}).call(this,o("543d")["default"])},"88e2":function(t,e,o){"use strict";o.r(e);var n=o("7a7c"),c=o.n(n);for(var i in n)"default"!==i&&function(t){o.d(e,t,(function(){return n[t]}))}(i);e["default"]=c.a},"9bf6":function(t,e,o){},af80:function(t,e,o){"use strict";o.r(e);var n=o("7511"),c=o("88e2");for(var i in c)"default"!==i&&function(t){o.d(e,t,(function(){return c[t]}))}(i);o("b120");var a,r=o("f0c5"),u=Object(r["a"])(c["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],a);e["default"]=u.exports},b120:function(t,e,o){"use strict";var n=o("9bf6"),c=o.n(n);c.a},c45a:function(t,e,o){"use strict";(function(t){o("e954");n(o("66fd"));var e=n(o("af80"));function n(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=o,t(e.default)}).call(this,o("543d")["createPage"])}},[["c45a","common/runtime","common/vendor"]]]);