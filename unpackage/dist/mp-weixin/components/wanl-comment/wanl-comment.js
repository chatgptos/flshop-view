(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/wanl-comment/wanl-comment"],{"2c64":function(t,e,n){"use strict";n.r(e);var a=n("6632"),o=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=o.a},6632:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(n("a34a"));function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n,a,o,i,r){try{var c=t[i](r),s=c.value}catch(u){return void n(u)}c.done?e(s):Promise.resolve(s).then(a,o)}function r(t){return function(){var e=this,n=arguments;return new Promise((function(a,o){var r=t.apply(e,n);function c(t){i(r,a,o,c,s,"next",t)}function s(t){i(r,a,o,c,s,"throw",t)}c(void 0)}))}}var c={name:"wanlComment",props:{findId:{type:Number,default:0},embedded:{type:Boolean,default:!1},commenCount:{type:Number,default:0},commentList:{type:Array,default:function(){return[]}},deleteTip:{type:String,default:"删除后不可找回，子评论将一并删除"}},data:function(){return{mainHeight:0,tabbarTop:0,tabbarHeight:0,commentReq:{pid:null,content:null},pUser:null,focus:!1}},mounted:function(){var e=this;return r(a.default.mark((function n(){var o;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:o=t.getSystemInfoSync(),e.mainHeight=o.windowHeight/1.8,e.tabbarTop=e.embedded?0:o.safeAreaInsets.bottom,e.tabbarHeight=(e.embedded?0:o.safeAreaInsets.bottom)+t.upx2px(70);case 4:case"end":return n.stop()}}),n)})))()},methods:{handleReply:function(t,e,n){this.pUser=t,this.commentReq.pid=n,this.commentReq.content=e?"@"+e+" ":"",this.commentInput()},handleLike:function(e){var n=arguments,o=this;return r(a.default.mark((function i(){var r,c;return a.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r=n.length>1&&void 0!==n[1]?n[1]:null,o.$store.state.user.isLogin?(c=null===r?o.commentList[e]:o.commentList[e].childlist[r],t.request({url:"".concat(o.$store.state.common.appUrl.api,"/flbooth/find/comments/likeData"),data:{id:c.id},header:{"Accept-Language":"zh-CN,zh;q=0.9",token:o.$store.state.user.token},success:function(e){1===e.data.code?(c.hasLike=e.data.data.data,e.data.data.data?c.like+=1:c.like-=1):t.showToast({title:e.data.msg,icon:"none"})}})):t.navigateTo({url:"/pages/user/auth/auth"});case 2:case"end":return a.stop()}}),i)})))()},handleAdd:function(){var e=this;return r(a.default.mark((function n(){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e.$store.state.user.isLogin){n.next=8;break}if(!(null==e.commentReq.content||e.commentReq.content.length<2)){n.next=4;break}return t.showToast({title:"评论内容过短",duration:2e3}),n.abrupt("return");case 4:e.commentReq.find_id=e.findId,t.request({url:"".concat(e.$store.state.common.appUrl.api,"/flbooth/find/comments/addData"),data:e.commentReq,header:{"Accept-Language":"zh-CN,zh;q=0.9",token:e.$store.state.user.token},method:"POST",success:function(n){1===n.data.code?(t.showToast({title:"评论成功",icon:"none"}),e.tagClose(),e.$emit("complete",{type:"add",count:e.commenCount+1})):t.showToast({title:n.data.msg,icon:"none"})}}),n.next=9;break;case 8:t.navigateTo({url:"/pages/user/auth/auth"});case 9:case"end":return n.stop()}}),n)})))()},handleDelete:function(e){var n=arguments,o=this;return r(a.default.mark((function i(){var r;return a.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r=n.length>1&&void 0!==n[1]?n[1]:null,o.$store.state.user.isLogin?t.showModal({content:o.deleteTip,confirmText:"确认删除",success:function(n){if(n.confirm){var a=null===r?o.commentList[e]:o.commentList[e].childlist[r];t.request({url:"".concat(o.$store.state.common.appUrl.api,"/flbooth/find/comments/delData"),data:{id:a.id,find_id:a.find_id},header:{"Accept-Language":"zh-CN,zh;q=0.9",token:o.$store.state.user.token},method:"POST",success:function(n){if(1===n.data.code){var a=o.commentList,i=o.commentList[e].childlist;null===r?a.splice(e,1):i.splice(r,1),o.$emit("complete",{type:"del",count:n.data.data.count})}else t.showToast({title:n.data.msg,icon:"none"})}})}}}):t.navigateTo({url:"/pages/user/auth/auth"});case 2:case"end":return a.stop()}}),i)})))()},tagClose:function(){this.pUser=null,this.commentReq.pid=null,this.commentReq.content=null},handleBlur:function(){this.focus=!1},commentInput:function(){this.focus=!0},formatHtml:function(t){return t.replace(/<\/?.+?>/g,"").replace(/ /g,"")},oss:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:120,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"jpg",r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"resize",c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:3,s=this.$store.state.common.appUrl.oss,u="",l=["m_lfit","m_mfit","m_fill","m_fixed"],d=["?x-oss-process=image","auto-orient,1","interlace,1","format,jpg","quality,q_90","sharpen,50","resize,m_fixed,w_120,h_120"];return"png"==i&&(d[3]=["format","png"].join(",")),d[6]=0==e?[r,l[a],"h_".concat(n*c)].join(","):0==n?[r,l[a],"w_".concat(e*c)].join(","):[r,l[a],"w_".concat(e*c),"h_".concat(n*c)].join(","),t?/^data:image\//.test(t)?u=t:/^(http|https):\/\/.+/.test(t)?(d.pop(),u=t+d.join("/")):u=s+t+d.join("/"):"transparent"==o||(u="avatar"==o?s+"/common/mine_def_touxiang_3x.png":s+"/common/img_default3x.png"),u}}};e.default=c}).call(this,n("543d")["default"])},b7d8:function(t,e,n){},c4c5:function(t,e,n){"use strict";var a;n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}));var o=function(){var t=this,e=t.$createElement,n=(t._self._c,0!=t.commentList.length?t.__map(t.commentList,(function(e,n){var a=t.__get_orig(e),o=t.oss(e.user.avatar,88,88),i=t.formatHtml(e.content),r=e.childlist.length>0?t.__map(e.childlist,(function(e,n){var a=t.__get_orig(e),o=t.oss(e.user.avatar,88,88),i=t.formatHtml(e.content);return{$orig:a,m2:o,m3:i}})):null;return{$orig:a,m0:o,m1:i,l0:r}})):null);t.$mp.data=Object.assign({},{$root:{l1:n}})},i=[]},cb0d6:function(t,e,n){"use strict";n.r(e);var a=n("c4c5"),o=n("2c64");for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n("fd21");var r,c=n("f0c5"),s=Object(c["a"])(o["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],r);e["default"]=s.exports},fd21:function(t,e,n){"use strict";var a=n("b7d8"),o=n.n(a);o.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/wanl-comment/wanl-comment-create-component',
    {
        'components/wanl-comment/wanl-comment-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("cb0d6"))
        })
    },
    [['components/wanl-comment/wanl-comment-create-component']]
]);
