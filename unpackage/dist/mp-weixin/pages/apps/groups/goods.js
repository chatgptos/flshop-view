(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/apps/groups/goods"],{"372b":function(t,e,o){"use strict";o.r(e);var n=o("5006"),r=o("bdb8");for(var i in r)"default"!==i&&function(t){o.d(e,t,(function(){return r[t]}))}(i);o("c4e4");var s,a=o("f0c5"),c=Object(a["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);e["default"]=c.exports},5006:function(t,e,o){"use strict";o.d(e,"b",(function(){return r})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){return n}));var n={wanlTimeout:function(){return o.e("components/wanl-timeout/wanl-timeout").then(o.bind(null,"1b31"))},wanlRate:function(){return o.e("components/wanl-rate/wanl-rate").then(o.bind(null,"3ca7"))},wanlDivider:function(){return o.e("components/wanl-divider/wanl-divider").then(o.bind(null,"8953"))},wanlProduct:function(){return o.e("components/wanl-product/wanl-product").then(o.bind(null,"8121"))},uniLoadMore:function(){return o.e("components/uni-load-more/uni-load-more").then(o.bind(null,"1e1f"))},wanlDirect:function(){return o.e("components/wanl-direct/wanl-direct").then(o.bind(null,"c414"))},wanlShare:function(){return Promise.all([o.e("common/vendor"),o.e("components/wanl-share/wanl-share")]).then(o.bind(null,"3b89"))},uniNumberBox:function(){return o.e("components/uni-number-box/uni-number-box").then(o.bind(null,"71cd"))}},r=function(){var t=this,e=t.$createElement,o=(t._self._c,t.__map(t.goodsData.images,(function(e,o){var n=t.__get_orig(e),r=t.$flbooth.oss(e,400,0);return{$orig:n,g0:r}}))),n=t.goodsData.shop.city?t.goodsData.shop.city.split("/"):null,r=0!=t.goodsData.coupon.length?t.__map(t.goodsData.coupon,(function(e,o){var n=t.__get_orig(e),r=o<2&&("reduction"==e.type||"vip"==e.type&&"reduction"==e.usertype)?Number(e.price):null,i=o<2&&("reduction"==e.type||"vip"==e.type&&"reduction"==e.usertype)?Number(e.limit):null,s=o<2&&("reduction"==e.type||"vip"==e.type&&"reduction"==e.usertype)?Number(e.price):null,a=o<2&&("discount"==e.type||"vip"==e.type&&"discount"==e.usertype)?Number(e.discount):null,c=o<2&&("discount"==e.type||"vip"==e.type&&"discount"==e.usertype)?Number(e.limit):null,u=o<2&&("discount"==e.type||"vip"==e.type&&"discount"==e.usertype)?Number(e.discount):null,l=o<2&&"shipping"==e.type?Number(e.limit):null;return{$orig:n,m0:r,m1:i,m2:s,m3:a,m4:c,m5:u,m6:l}})):null,i=t.canCount?null:t.__map(t.selectArr,(function(e,o){var n=t.__get_orig(e),r=t.$base64.decode(e);return{$orig:n,g2:r}})),s=t.__map(t.goodsData.spu,(function(e,o){var n=t.__get_orig(e),r=t.__map(e.item,(function(e,n){var r=t.__get_orig(e),i=0==o?t.$base64.decode(e.name):null;return{$orig:r,g3:i}}));return{$orig:n,l3:r}})),a=t.goodsData.groups&&t.goodsData.groups.list.length>0?t.__map(t.goodsData.groups.list,(function(e,o){var n=t.__get_orig(e),r=t.$flbooth.oss(e.user.avatar,52,52,2,"avatar");return{$orig:n,g4:r}})):null,c=t.goodsData.comment>0?parseInt(t.goodsData.praise/t.goodsData.comment*100):null,u=t.__map(t.goodsData.comment_list.data,(function(e,o){var n=t.__get_orig(e),r=t.$flbooth.oss(e.user.avatar,26,26,2,"avatar"),i=0!=e.images.length?t.__map(e.images,(function(e,o){var n=t.__get_orig(e),r=o<=3?t.$flbooth.oss(e,88,88):null;return{$orig:n,g6:r}})):null;return{$orig:n,g5:r,l6:i}})),l=t.$flbooth.oss(t.goodsData.shop.avatar,52,52,2,"avatar"),d=t.$flbooth.toFormat(t.goodsData.shop.find_user.fans,"thousand"),p=t.__map(t.goodsData.shop_recommend,(function(e,o){var n=t.__get_orig(e),r=t.$flbooth.oss(e.image,125,120);return{$orig:n,g9:r}})),h=t.goodsData.groups?t.__map(t.goodsData.groups.list,(function(e,o){var n=t.__get_orig(e),r=t.$flbooth.oss(e.user.avatar,52,52,2,"avatar");return{$orig:n,g10:r}})):null,g=t.$flbooth.appstc("/coupon/bg_coupon_3x.png"),f=t.__map(t.goodsData.coupon,(function(e,o){var n=t.__get_orig(e),r=e.state?t.$flbooth.appstc("/coupon/img_couponcentre_received_3x.png"):null,i="reduction"==e.type||"vip"==e.type&&"reduction"==e.usertype?Number(e.price):null,s="reduction"==e.type||"vip"==e.type&&"reduction"==e.usertype?Number(e.limit):null,a="reduction"==e.type||"vip"==e.type&&"reduction"==e.usertype?Number(e.price):null,c="discount"==e.type||"vip"==e.type&&"discount"==e.usertype?Number(e.discount):null,u="discount"==e.type||"vip"==e.type&&"discount"==e.usertype?Number(e.limit):null,l="discount"==e.type||"vip"==e.type&&"discount"==e.usertype?Number(e.discount):null,d="shipping"==e.type?Number(e.limit):null;return{$orig:n,g12:r,m8:i,m9:s,m10:a,m11:c,m12:u,m13:l,m14:d}})),m=t.$flbooth.oss(t.goodsData.image,50,50),_=t.$flbooth.oss(t.selectshop.thumbnail||t.goodsData.image,100,100),b="alone"!=t.isChoice?t.groupPrice():null,y=t.selectArr.join(""),v=t.selectArr.join(""),w=v?t.__map(t.selectArr,(function(e,o){var n=t.__get_orig(e),r=t.$base64.decode(e);return{$orig:n,g17:r}})):null,$=v?null:t.__map(t.goodsData.spu,(function(e,o){var n=t.__get_orig(e),r=t.$base64.decode(e.name);return{$orig:n,g18:r}})),D=t.__map(t.goodsData.spu,(function(e,o){var n=t.__get_orig(e),r=t.__map(e.item,(function(e,o){var n=t.__get_orig(e),r=t.$base64.decode(e.name);return{$orig:n,g19:r}}));return{$orig:n,l13:r}})),k=t.isChoice?null:t.groupPrice(),x=t.goodsData.interval_price?t.groupPrice():null;t._isMounted||(t.e0=function(e){return t.$flbooth.back(1)}),t.$mp.data=Object.assign({},{$root:{l0:o,g1:n,l1:r,l2:i,l4:s,l5:a,m7:c,l7:u,g7:l,g8:d,l8:p,l9:h,g11:g,l10:f,g13:m,g14:_,m15:b,g15:y,g16:v,l11:w,l12:$,l14:D,m16:k,m17:x}})},i=[]},"6eda":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(o("a34a")),r=o("26cb");function i(t){return t&&t.__esModule?t:{default:t}}function s(t){return u(t)||c(t)||d(t)||a()}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function u(t){if(Array.isArray(t))return p(t)}function l(t,e){var o;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=d(t))||e&&t&&"number"===typeof t.length){o&&(t=o);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){o=t[Symbol.iterator]()},n:function(){var t=o.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==o.return||o.return()}finally{if(a)throw i}}}}function d(t,e){if(t){if("string"===typeof t)return p(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}function h(t,e,o,n,r,i,s){try{var a=t[i](s),c=a.value}catch(u){return void o(u)}a.done?e(c):Promise.resolve(c).then(n,r)}function g(t){return function(){var e=this,o=arguments;return new Promise((function(n,r){var i=t.apply(e,o);function s(t){h(i,n,r,s,a,"next",t)}function a(t){h(i,n,r,s,a,"throw",t)}s(void 0)}))}}function f(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function m(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?f(Object(o),!0).forEach((function(e){_(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):f(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function _(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var b={data:function(){return{TabCur:0,wanlsys:{},modalName:null,durect:0,headerOpacity:0,currentSwiper:0,anchorlist:[{name:"主图",top:0},{name:"评价",top:0},{name:"详情",top:0},{name:"推荐",top:0}],selectAnchor:0,groups_id:0,goodsData:{id:0,category_id:0,shop_id:0,brand_id:0,freight_id:0,title:"",image:"",images:"",is_alone:0,people_num:0,is_ladder:0,flag:"",content:"",category_attribute:[],price:0,interval_price:0,interval_market_price:0,market_price:0,min_price:0,sales:0,brand:{},freight:{name:"",isdelivery:1},payment:0,comment:0,praise:0,moderate:0,negative:0,like:0,views:0,status:"",category:{},follow:!0,sku:[],spu:[],promotion:[],coupon:[],comment_list:{data:[],figure:0,tag:[]},shop:{find_user:{fans:0},city:""},shop_recommend:{}},reload:!0,likeData:[],current_page:1,last_page:1,status:"loading",contentText:{contentdown:" ",contentrefresh:"正在加载...",contentnomore:"没有更多数据了"},shopItemInfo:{},selectArr:[],subIndex:[],selectshop:{},selectNum:1,isChoice:"",scrollAnimation:100,ladderIndex:null,ladder_id:null}},onLoad:function(t){this.wanlsys=this.$flbooth.wanlsys(),t.groups_id&&(this.groups_id=Number(t.groups_id)),this.loadData(t),this.loadlikeData(),wx.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]}),this.durect=this.$store.state.statistics.notice.notice+this.$store.state.statistics.notice.order+this.$store.state.statistics.notice.chat+this.$store.state.statistics.order.pay+this.$store.state.statistics.order.delive+this.$store.state.statistics.order.receiving+this.$store.state.statistics.order.evaluate},onPageScroll:function(t){var e=150;t.scrollTop=t.scrollTop>e?150:t.scrollTop,this.headerOpacity=t.scrollTop*(1/e)},onReachBottom:function(){this.current_page>=this.last_page?this.status="noMore":(this.reload=!1,this.current_page=this.current_page+1,this.status="loading",this.loadlikeData())},watch:{selectshop:function(t,e){"group"===this.isChoice?t.price!=e.price&&this.queryCoupon(this.groupPrice()):t.market_price!=e.market_price&&this.queryCoupon(t.market_price)},ladderIndex:function(t,e){t!==e&&this.queryCoupon(this.groupPrice())}},computed:m({canCount:function(){return this.subIndex.some((function(t){return-1===t}))}},(0,r.mapState)(["cart","common"])),methods:{loadData:function(t){var e=this;return g(n.default.mark((function o(){return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:e.$api.get({url:"/flbooth/groups/product/goods",data:t,success:function(t){if(t.content=t.content.replace(/<img [^>]*src=['"]([^'"]+)[^>]*>/gi,(function(t,o){var n='<img style="display: block; max-width: 100%;" src="'.concat(e.$flbooth.oss(o,500,0),'">');return n})),0==t.sku.length)t.min_price=t.price,t.interval_price=t.price,t.market_price=t.price;else{var o,n=[],r=[],i=l(t.sku);try{for(i.s();!(o=i.n()).done;){var s=o.value;n.push(s.price),r.push(s.market_price)}}catch(p){i.e(p)}finally{i.f()}var a=Math.min.apply(null,n),c=Math.max.apply(null,n),u=Math.min.apply(null,r),d=Math.max.apply(null,r);t.min_price=Number(a).toFixed(2),t.market_price=Number(d).toFixed(2),t.interval_price=a==c?Number(a).toFixed(2):a+"-"+Number(c).toFixed(2),t.interval_market_price=u==d?Number(u).toFixed(2):u+"-"+Number(d).toFixed(2)}0!==e.groups_id&&2!==t.groups.type&&(e.groups_id=0),e.goodsData=t,e.goodsData.spu.map((function(t){t.item.map((function(t,o,n){n[o].name=e.$base64.encode(n[o].name)})),e.selectArr.push(""),e.subIndex.push(-1)})),e.goodsData.sku.map((function(t){t.difference.map((function(t,o,n){n[o]=e.$base64.encode(t)}))})),e.checkItem(),e.checkInpath(-1),setTimeout((function(){e.calcAnchor()}),1e3)}});case 1:case"end":return o.stop()}}),o)})))()},loadlikeData:function(){var t=this;return g(n.default.mark((function e(){return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$api.get({url:"/flbooth/product/likes?pages=goods",data:{page:t.current_page},success:function(e){t.likeData=t.reload?e.data:t.likeData.concat(e.data),t.current_page=e.current_page,t.last_page=e.last_page,t.status="more"}});case 1:case"end":return e.stop()}}),e)})))()},queryCoupon:function(t){var e=this;return g(n.default.mark((function o(){return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:e.$api.post({url:"/flbooth/coupon/query",data:{shop_id:e.goodsData.shop_id,goods_id:e.goodsData.id,shop_category_id:e.goodsData.shop_category_id,price:t},success:function(t){e.goodsData.coupon=t}});case 1:case"end":return o.stop()}}),o)})))()},onReceive:function(t){var e=this;return g(n.default.mark((function o(){var r;return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:r=e.goodsData.coupon[t],e.$api.post({url:"/flbooth/coupon/receive",loadingTip:"领取中",data:{id:r.id},success:function(t){r.id=t.id,r.state=!0,e.$flbooth.msg(t.msg),e.$store.commit("statistics/dynamic",{coupon:e.$store.state.statistics.dynamic.coupon+1})}});case 2:case"end":return o.stop()}}),o)})))()},loadStock:function(t){var e=this;return g(n.default.mark((function o(){return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:e.$api.get({url:"/flbooth/groups/product/stock",data:{sku_id:t},success:function(t){e.selectshop.stock=t}});case 1:case"end":return o.stop()}}),o)})))()},ladderClick:function(t){this.ladderIndex=t,this.ladder_id=this.goodsData.groups.ladder[t].id},groupPrice:function(){var t=0;return t=this.selectshop.price?null!==this.ladderIndex&&1===this.goodsData.is_ladder?this.$flbooth.bcmul(this.selectshop.price,this.goodsData.groups.ladder[this.ladderIndex].discount)/100:this.selectshop.price:this.goodsData.min_price,t},skuClick:function(t,e,o,n){var r=this;t.ishow&&(this.selectArr[e]!=t.name?(this.$set(this.selectArr,e,t.name),this.$set(this.subIndex,e,n)):(this.$set(this.selectArr,e,""),this.$set(this.subIndex,e,-1)),this.checkInpath(e),this.selectArr.every((function(t){return""!=t}))&&(this.selectshop=this.shopItemInfo[this.selectArr],this.selectshop.difference.map((function(t,e,o){o[e]=r.$base64.decode(t)})),this.loadStock(this.selectshop.id),this.selectNum=1))},checkInpath:function(t){for(var e=0,o=this.goodsData.spu.length;e<o;e++)if(e!=t)for(var n=this.goodsData.spu[e].item.length,r=0;r<n;r++)if(-1==this.subIndex[e]||r!=this.subIndex[e]){var i=s(this.selectArr);this.$set(i,e,this.goodsData.spu[e].item[r].name);var a=i.filter((function(t){return""!==t&&"undefined"!==typeof t}));this.shopItemInfo.hasOwnProperty(a)?this.$set(this.goodsData.spu[e].item[r],"ishow",!0):this.$set(this.goodsData.spu[e].item[r],"ishow",!1)}},checkItem:function(){var t=this;this.goodsData.sku.reduce((function(e,o){return e.concat(o.difference.reduce((function(e,n){return e.concat(e.map((function(e){return t.shopItemInfo.hasOwnProperty([].concat(s(e),[n]))||(t.shopItemInfo[[].concat(s(e),[n])]=o),[].concat(s(e),[n])})))}),[[]]))}),[[]])},changeNum:function(t){if(this.selectshop.stock){var e=parseInt(t);e>this.selectshop.stock?(this.$flbooth.msg("数量不能超过库存 ".concat(this.selectshop.stock," 件")),this.selectNum=parseInt(this.selectshop.stock)):this.selectNum=parseInt(t)}},swiperChange:function(t){this.currentSwiper=t.detail.current},showModal:function(t){var e=this;this.isChoice="","share"==t&&"share"!=this.modalName&&setTimeout((function(){e.scrollAnimation=0}),300),this.modalName=t},hideModal:function(t){t?this.showModal(t):this.modalName=null},wanlShare:function(t){t?this.$flbooth.auth("/pages/user/complaint/complaint?id=".concat(this.goodsData.id,"&type=3")):this.modalName=null},moveHandle:function(){},follow:function(){var t=this;this.goodsData.follow=!this.goodsData.follow,this.goodsData.follow?this.$store.commit("statistics/dynamic",{collection:this.$store.state.statistics.dynamic.collection+1}):this.$store.commit("statistics/dynamic",{collection:this.$store.state.statistics.dynamic.collection-1}),this.$api.post({url:"/flbooth/groups/product/follow",data:{id:this.goodsData.id},success:function(e){t.goodsData.follow=e}})},toAnchor:function(e){this.selectAnchor=e,t.pageScrollTo({scrollTop:this.anchorlist[e].top,duration:200})},calcAnchor:function(){var e=this,o=null;o=t.createSelectorQuery().in(this),o.select("#evaluate").boundingClientRect((function(t){e.anchorlist[1].top=t.top-e.wanlsys.height-45})).exec(),o.select("#details").boundingClientRect((function(t){e.anchorlist[2].top=t.top-e.wanlsys.height-45})).exec(),o.select("#recommend").boundingClientRect((function(t){e.anchorlist[3].top=t.top-e.wanlsys.height-45})).exec()},onTag:function(t){this.$flbooth.to("/pages/product/comment?id="+this.goodsData.id+"&praise="+this.goodsData.praise+"&tag="+t)},toCart:function(){t.switchTab({url:"/pages/cart"})},completeSelection:function(){this.canCount?this.$flbooth.msg("请选择完成规格"):1===this.goodsData.is_ladder&&"group"===this.isChoice?null!==this.ladderIndex?this.ProcessingData():0===this.groups_id?this.$flbooth.msg("请选择阶梯拼团人数"):(this.ladder_id=this.goodsData.groups.choiceList.ladder_id,this.ProcessingData()):this.ProcessingData()},SubmitData:function(t,e,o){o&&(this.groups_id=o.id,this.goodsData.groups.choiceList=o),1==e?this.canCount?this.$flbooth.msg("请选择完成规格"):(this.isChoice=t,1===this.goodsData.is_ladder&&"group"===t?null!==this.ladderIndex?this.ProcessingData():this.$flbooth.msg("请选择阶梯拼团人数"):this.ProcessingData()):(this.modalName="option",this.isChoice=t)},ProcessingData:function(){var e=this;return g(n.default.mark((function o(){var r;return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:e.isChoice?(r=[{goods_id:e.goodsData.id,number:e.selectNum,sku_id:e.selectshop.id,groups_id:e.groups_id,ladder_id:e.ladder_id,type:e.isChoice}],e.$store.state.user.isLogin?0===e.goodsData.purchase_limit||"alone"===e.isChoice?t.redirectTo({url:"/pages/apps/groups/order/confirm?order_type=groups&data=".concat(JSON.stringify(r))}):e.$api.get({url:"/flbooth/groups/order/getOrderPurchaseLimit",data:{id:e.goodsData.id},success:function(e){t.redirectTo({url:"/pages/apps/groups/order/confirm?order_type=groups&data=".concat(JSON.stringify(r))})}}):e.$flbooth.to("/pages/user/auth/auth")):e.$flbooth.msg("数据异常"),e.hideModal();case 2:case"end":return o.stop()}}),o)})))()},productSearch:function(t){this.$flbooth.to("/pages/page/search?type=groups&keywords=".concat(t),"fade-in",100)}}};e.default=b}).call(this,o("543d")["default"])},"9c56":function(t,e,o){},bdb8:function(t,e,o){"use strict";o.r(e);var n=o("6eda"),r=o.n(n);for(var i in n)"default"!==i&&function(t){o.d(e,t,(function(){return n[t]}))}(i);e["default"]=r.a},c4e4:function(t,e,o){"use strict";var n=o("9c56"),r=o.n(n);r.a},f534:function(t,e,o){"use strict";(function(t){o("e954");n(o("66fd"));var e=n(o("372b"));function n(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=o,t(e.default)}).call(this,o("543d")["createPage"])}},[["f534","common/runtime","common/vendor"]]]);