(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/apps/find/user"],{"28e0":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(a("a34a")),o=a("26cb");function s(t){return t&&t.__esModule?t:{default:t}}function r(t,e,a,n,o,s,r){try{var i=t[s](r),u=i.value}catch(l){return void a(l)}i.done?e(u):Promise.resolve(u).then(n,o)}function i(t){return function(){var e=this,a=arguments;return new Promise((function(n,o){var s=t.apply(e,a);function i(t){r(s,n,o,i,u,"next",t)}function u(t){r(s,n,o,i,u,"throw",t)}i(void 0)}))}}function u(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?u(Object(a),!0).forEach((function(e){c(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function c(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var d={data:function(){return{headHeight:0,headerOpacity:0,windowHeight:0,headTop:0,isMyfind:!1,loadingFollow:!1,modalName:null,scrollAnimation:300,userData:{user_no:"",user:{avatar:"",nickname:"加载中.."},follow:0,fans:0,likes:0,praised:0,color:"#e9dacd",image:"",isFollow:0},stateText:{publish:{icon:"wlIcon-jiazai wlIconfont-spin",text:"发布中",color:"#fff"},examine:{icon:"wlIcon-shouhoufuwu-zidongpingjia",text:"待审核",color:"#e6442b"},hazard:{icon:"wlIcon-zhuyidapx",text:"内容违规",color:"#e6442b"},transcoding:{icon:"wlIcon-jiazai1 wlIconfont-spin",text:"转码中",color:"#fff"},screenshot:{icon:"wlIcon-tupian wlIconfont-spin",text:"生成封面中",color:"#fff"}},currentId:0,typeList:{new:"bg-gradual-yellow",live:"wanl-bg-orange",want:"bg-gradual-green",activity:"bg-gradual-orange",show:"wanl-bg-pink",video:"wanl-bg-pink"},navList:[{type:"works",type_text:"作品",dataList:[],loadingType:"more",current_page:1},{type:"likes",type_text:"喜欢",dataList:[],loadingType:"more",current_page:1}],contentText:{contentdown:" ",contentrefresh:"正在疯狂加载中...",contentnomore:"我是有底线的"}}},computed:l({},(0,o.mapState)(["common"])),onLoad:function(t){var e=this.$flbooth.wanlsys();this.headTop=e.top,this.headHeight=e.height,this.windowHeight=e.windowHeight,t.id?this.loadData(t):this.loadData({id:null})},onReachBottom:function(){this.loadFindData()},onPageScroll:function(t){var e=170;t.scrollTop=t.scrollTop>e?170:t.scrollTop,this.headerOpacity=t.scrollTop*(1/e)},methods:{loadData:function(t){var e=this;return i(n.default.mark((function a(){return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.$api.post({url:"/flbooth/find/user/userInfo",data:t,success:function(t){t.user_id===e.$store.state.user.id&&(e.isMyfind=!0),e.userData=t,e.loadFindData()}});case 1:case"end":return a.stop()}}),a)})))()},loadFindData:function(t){var e=this,a=this.navList[this.currentId];if("noMore"!=a.loadingType&&("tabChange"!==t||!0!==a.loaded)&&"loading"!==a.loadingType){a.loadingType="loading";var n="works"===a.type&&this.isMyfind?"myfind":a.type;this.$api.get({url:"/flbooth/find/find/getList",data:{type:n,user_no:this.userData.user_no,page:a.current_page},success:function(t){a.current_page=t.current_page,t.last_page===t.current_page?a.loadingType="noMore":(a.loadingType="more",a.current_page++),t.data.forEach((function(t){a.dataList.push(t)})),e.$set(a,"loaded",!0)}})}},handleFollow:function(t){var e=this;return i(n.default.mark((function a(){return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.$store.state.user.isLogin?(e.loadingFollow=!0,e.$api.post({url:"/flbooth/find/user/setFindUser",data:{id:e.userData.user_no,type:"follow"},success:function(a){if(t){var n=e.$store.state.statistics.dynamic.concern;0===a.data?n-=1:n+=1,e.$store.commit("statistics/dynamic",{concern:n})}1===a.data?e.userData.fans+=1:0===a.data&&(e.userData.fans-=1),e.userData.isFollow=a.data,e.loadingFollow=!1}})):e.$flbooth.to("/pages/user/auth/auth");case 1:case"end":return a.stop()}}),a)})))()},handleLike:function(t){var e=this;return i(n.default.mark((function a(){var o;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.$store.state.user.isLogin?(o=e.navList[e.currentId].dataList[t],e.$api.post({url:"/flbooth/find/user/setFindUser",data:{id:o.id,type:"likes"},success:function(t){0===t.data?o.likes-=1:o.likes+=1,o.isLike=t.data}})):e.$flbooth.to("/pages/user/auth/auth");case 1:case"end":return a.stop()}}),a)})))()},handleDel:function(e){var a=this;return i(n.default.mark((function o(){return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a.$store.state.user.isLogin?t.showModal({content:"确定要删除此作品？",success:function(t){if(t.confirm){var n=a.navList[a.currentId].dataList;a.$api.post({url:"/flbooth/find/find/delData",data:{id:n[e].id},loadingTip:"删除作品中",success:function(t){n.splice(e,1)}})}}}):a.$flbooth.to("/pages/user/auth/auth");case 1:case"end":return n.stop()}}),o)})))()},handleTheme:function(){var e=this;return i(n.default.mark((function a(){return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.isMyfind&&t.showActionSheet({itemList:["从主题库选择背景","从相册上传图片"],success:function(a){0===a.tapIndex?e.$flbooth.to("/pages/user/theme"):1===a.tapIndex&&t.chooseImage({success:function(t){e.$api.get({url:"/flbooth/common/uploadData",success:function(a){e.$api.upload({url:a.uploadurl,loadingTip:"主题上传中...",filePath:t.tempFilePaths[0],name:"file",formData:"local"==a.storage?null:a.multipart,success:function(t){e.editTheme({url:t.url,type:"upload"})}})}})}})}});case 1:case"end":return a.stop()}}),a)})))()},editTheme:function(t){var e=this;this.$api.post({url:"/flbooth/find/user/editTheme",loadingTip:"更改主题中...",data:t,success:function(t){e.userData.image=t.image,e.userData.color=t.color}})},handlePublish:function(){var e=this,a=[],n=[];this.userData.shop?this.userData.isVideo?this.userData.isLive?(a=["发布种草","发布短视频","商家直播"],n=["/pages/apps/find/user/add?type=want","/pages/apps/find/user/add?type=video","/pages/shop/live/live"]):(a=["发布种草","发布短视频"],n=["/pages/apps/find/user/add?type=want","/pages/apps/find/user/add?type=video"]):this.userData.isLive?(a=["发布种草","商家直播"],n=["/pages/apps/find/user/add?type=want","/pages/apps/find/user/add?type=video"]):(a=["发布种草"],n=["/pages/apps/find/user/add?type=want"]):this.userData.isVideo?(a=["发布种草","发布短视频"],n=["/pages/apps/find/user/add?type=want","/pages/apps/find/user/add?type=video"]):(a=["发布种草"],n=["/pages/apps/find/user/add?type=want"]),t.showActionSheet({itemList:a,success:function(t){t.tapIndex,e.$flbooth.to(n[t.tapIndex])}})},handleSelect:function(t){this.currentId=t,this.loadFindData("tabChange")},handleBack:function(){this.$flbooth.back(1)},handleUserEdit:function(){this.$flbooth.auth("/pages/user/setting/user")},formatHtml:function(t){return t.replace(/<\/?.+?>/g,"").replace(/ /g,"")},showModal:function(t){var e=this;"share"==t&&"share"!=this.modalName&&setTimeout((function(){e.scrollAnimation=300}),300),this.modalName=t},hideModal:function(t){t?this.showModal(t):this.modalName=null}}};e.default=d}).call(this,a("543d")["default"])},4651:function(t,e,a){"use strict";var n=a("dfd5"),o=a.n(n);o.a},"89fa":function(t,e,a){"use strict";a.r(e);var n=a("c674"),o=a("ae6e");for(var s in o)"default"!==s&&function(t){a.d(e,t,(function(){return o[t]}))}(s);a("4651");var r,i=a("f0c5"),u=Object(i["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);e["default"]=u.exports},ae6e:function(t,e,a){"use strict";a.r(e);var n=a("28e0"),o=a.n(n);for(var s in n)"default"!==s&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=o.a},c674:function(t,e,a){"use strict";a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return n}));var n={wanlEmpty:function(){return a.e("components/wanl-empty/wanl-empty").then(a.bind(null,"e5e5"))},uniLoadMore:function(){return a.e("components/uni-load-more/uni-load-more").then(a.bind(null,"1e1f"))},wanlDirect:function(){return a.e("components/wanl-direct/wanl-direct").then(a.bind(null,"c414"))},wanlShare:function(){return Promise.all([a.e("common/vendor"),a.e("components/wanl-share/wanl-share")]).then(a.bind(null,"3b89"))}},o=function(){var t=this,e=t.$createElement,a=(t._self._c,t.$flbooth.oss(t.userData.image,0,50,1,"transparent","png")),n=t.$flbooth.oss(t.userData.user.avatar,88,88),o=t.$flbooth.toFormat(t.userData.follow<0?0:t.userData.follow,"thousand"),s=t.$flbooth.toFormat(t.userData.fans<0?0:t.userData.fans,"thousand"),r=t.$flbooth.toFormat(t.userData.praised<0?0:t.userData.praised,"thousand"),i=t.userData.shop?t.$flbooth.oss(t.userData.shop.avatar,88,88):null,u=t.__map(t.navList,(function(e,a){var n=t.__get_orig(e),o=t.isMyfind&&0===e.dataList.length&&e.loaded?t.$flbooth.appstc("/default/collect_default3x.png"):null,s=e.dataList.length>0?t.__map(e.dataList,(function(e,a){var n=t.__get_orig(e),o="normal"===e.state?t.$flbooth.oss(e.images[0],200,0):null,s="normal"===e.state?t.$flbooth.oss(e.images[0],200,0):null,r="normal"!==e.state?t.$flbooth.oss(e.images[0],200,0):null,i=t.formatHtml(e.content),u=t.$flbooth.timeFormat(e.created,"mm-dd");return{$orig:n,g7:o,g8:s,g9:r,m0:i,g10:u}})):null;return{$orig:n,g6:o,l0:s}})),l=t.$flbooth.appstc("/common/logo.png"),c=t.$flbooth.appstc("/common/find_fans3x.png"),d=t.$flbooth.toFormat(t.userData.praised<0?0:t.userData.praised,"thousand");t._isMounted||(t.e0=function(e){return e.stopPropagation(),t.$flbooth.copy(t.userData.user_no)},t.e1=function(e){return e.stopPropagation(),t.$flbooth.to("/pages/apps/find/user/follow?id="+t.userData.user_no)},t.e2=function(e){return e.stopPropagation(),t.$flbooth.to("/pages/apps/find/user/fans?id="+t.userData.user_no)},t.e3=function(e){return t.$flbooth.to("/pages/apps/find/list")},t.e4=function(e,a){var n=arguments[arguments.length-1].currentTarget.dataset,o=n.eventParams||n["event-params"];a=o.item;return t.$flbooth.msg("内容"+t.stateText[a.state].text+", 无法查看")}),t.$mp.data=Object.assign({},{$root:{g0:a,g1:n,g2:o,g3:s,g4:r,g5:i,l1:u,g11:l,g12:c,g13:d}})},s=[]},dfd5:function(t,e,a){},fdf5:function(t,e,a){"use strict";(function(t){a("e954");n(a("66fd"));var e=n(a("89fa"));function n(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=a,t(e.default)}).call(this,a("543d")["createPage"])}},[["fdf5","common/runtime","common/vendor"]]]);