(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product/list"],{"077f":function(t,a,e){"use strict";(function(t){e("e954");r(e("66fd"));var a=r(e("db13"));function r(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=e,t(a.default)}).call(this,e("543d")["createPage"])},"106b":function(t,a,e){},"4f13":function(t,a,e){"use strict";e.r(a);var r=e("74c8"),i=e.n(r);for(var o in r)"default"!==o&&function(t){e.d(a,t,(function(){return r[t]}))}(o);a["default"]=i.a},"74c8":function(t,a,e){"use strict";(function(t){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=i(e("a34a"));function i(t){return t&&t.__esModule?t:{default:t}}function o(t,a,e,r,i,o,c){try{var n=t[o](c),s=n.value}catch(h){return void e(h)}n.done?a(s):Promise.resolve(s).then(r,i)}function c(t){return function(){var a=this,e=arguments;return new Promise((function(r,i){var c=t.apply(a,e);function n(t){o(c,r,i,n,s,"next",t)}function s(t){o(c,r,i,n,s,"throw",t)}n(void 0)}))}}var n={data:function(){return{WanlScroll:0,scrollStype:!1,filterIndex:0,priceOrder:0,liststyle:"col-2-20",goodsData:[],showRight:!1,category:"",goodsType:"goods",empty:"没有找到任何宝贝",params:{search:"",sort:"weigh",order:"asc",page:1,filter:{},op:{}},likeData:[],drawerType:{attribute:!1,first:!1,city:!1},drawerData:{price:{low:"",high:""},brand:[],attribute:[],sameCity:{name:" 定位中..",choice:!1},city:[{name:"北京",choice:!1},{name:"天津",choice:!1},{name:"河北",choice:!1},{name:"山西",choice:!1},{name:"内蒙古",choice:!1},{name:"山东",choice:!1},{name:"江苏",choice:!1},{name:"上海",choice:!1},{name:"浙江",choice:!1},{name:"安徽",choice:!1},{name:"福建",choice:!1},{name:"江西",choice:!1},{name:"河南",choice:!1},{name:"湖南",choice:!1},{name:"湖北",choice:!1},{name:"广东",choice:!1},{name:"广西",choice:!1},{name:"海南",choice:!1},{name:"辽宁",choice:!1},{name:"吉林",choice:!1},{name:"黑龙江",choice:!1},{name:"四川",choice:!1},{name:"贵州",choice:!1},{name:"云南",choice:!1},{name:"重庆",choice:!1},{name:"宁夏",choice:!1},{name:"青海",choice:!1},{name:"陕西",choice:!1},{name:"甘肃",choice:!1},{name:"新疆",choice:!1},{name:"西藏",choice:!1},{name:"香港",choice:!1},{name:"澳门",choice:!1},{name:"台湾",choice:!1}]},drawerParams:{},reload:!1,last_page:0,status:"loading",contentText:{contentdown:"",contentrefresh:"正在加载..",contentnomore:"没有更多数据了"}}},onLoad:function(a){var e=this;if(a.type&&(this.goodsType=a.type),a.search)this.params.search=a.search,this.drawerParams.search=a.search;else if(a.data){var r=JSON.parse(a.data);this.drawerParams.category_id=r.category_id,this.category=r.category_name,this.params.filter.category_id=r.category_id,this.params.op.category_id="in"}else console.log("调试模式");t.getLocation({type:"wgs84",geocode:!0,success:function(a){t.request({url:"https://restapi.amap.com/v3/geocode/regeo",data:{key:e.$flbooth.config("amapkey"),location:a.longitude+","+a.latitude},success:function(t){if(200==t.statusCode){var a=t.data.regeocode.addressComponent;e.drawerData.sameCity.name=a.province}}})}}),this.loadData(),0==this.goodsData.length&&this.loadlikeData()},onPullDownRefresh:function(){this.params.page=1,this.reload=!0,this.loadData()},onReachBottom:function(){this.params.page>=this.last_page?this.status="noMore":(this.reload=!1,this.contentText.contentdown="上拉显示更多",this.params.page=this.params.page+1,this.status="loading",this.loadData())},onPageScroll:function(t){t.scrollTop>this.WanlScroll?this.scrollStype=!1:this.scrollStype=!0,t.scrollTop<0&&(this.scrollStype=!1),this.WanlScroll=t.scrollTop},onUnload:function(){if(this.showRight)return this.closeDrawer(),!0},methods:{loadData:function(){var a=this;return c(r.default.mark((function e(){return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a.params.type=a.goodsType,a.$api.get({url:"/flbooth/product/lists",data:a.params,success:function(e){t.stopPullDownRefresh(),a.status="more",a.goodsData=a.reload?e.data:a.goodsData.concat(e.data),0==e.data.length&&(a.empty="没找到与“".concat(a.category).concat(a.params.search,'"相关的宝贝')),a.params.page=e.current_page,a.last_page=e.last_page}});case 2:case"end":return e.stop()}}),e)})))()},loadlikeData:function(){var t=this;return c(r.default.mark((function a(){return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$api.get({url:"/flbooth/product/likes?pages=".concat(t.goodsType),success:function(a){t.likeData=a.data}});case 1:case"end":return a.stop()}}),a)})))()},loadDrawer:function(){var t=this;return c(r.default.mark((function a(){return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.drawerParams.type=t.goodsType,t.$api.get({url:"/flbooth/product/drawer",data:t.drawerParams,success:function(a){var e=[],r=[];a.brand&&a.brand.forEach((function(t){var a={id:t.id,name:t.name,fold:!1,choice:!1};e.push(a)})),a.attribute&&a.attribute.forEach((function(t){var a=[];t.value.forEach((function(t){var e={name:t.name,choice:!1};a.push(e)}));var e={name:t.name,value:a,fold:!1};r.push(e)})),t.drawerData.brand=e,t.drawerData.attribute=r}});case 2:case"end":return a.stop()}}),a)})))()},tabClick:function(a){this.filterIndex===a&&3!==a||(this.filterIndex=a,this.priceOrder=3===a?1===this.priceOrder?2:1:0,0===a&&(this.params.sort="weigh",this.params.order="desc"),1===a&&(this.params.sort="sales",this.params.order="desc"),2===a&&(this.params.sort="created",this.params.order="desc"),3===a&&1===this.priceOrder&&(this.params.sort="price",this.params.order="desc"),3===a&&2===this.priceOrder&&(this.params.sort="price",this.params.order="asc"),this.status="loading",this.params.page=1,this.reload=!0,this.loadData(),t.pageScrollTo({duration:300,scrollTop:0}))},showDrawer:function(){this.showRight=!0,this.drawerType.first||(this.loadDrawer(),this.drawerType.first=!0)},onDraver:function(t){var a=t.currentTarget.dataset.attribute,e=t.currentTarget.dataset.key;"brand"==e||"city"==e?(this.drawerData[e].forEach((function(t,e){e!=a&&(t.choice=!1)})),this.drawerData.sameCity.choice=!1,this.drawerData[e][a].choice=!this.drawerData[e][a].choice):"sameCity"==e?(this.drawerData.city.forEach((function(t){t.choice=!1})),this.drawerData.sameCity.choice=!this.drawerData.sameCity.choice):(this.drawerData.attribute[a].value.forEach((function(t,a){a!=e&&(t.choice=!1)})),this.drawerData.attribute[a].value[e].choice=!this.drawerData.attribute[a].value[e].choice)},onDrawerTo:function(){""!=this.drawerData.price.low&&""!=this.drawerData.price.high?(this.params.filter.price=this.drawerData.price.low+","+this.drawerData.price.high,this.params.op.price="BETWEEN"):(delete this.params.filter.price,delete this.params.op.price);var t="";this.drawerData.city.forEach((function(a){a.choice&&(t=a.name)})),t?(this.params.filter["shop.city"]="%"+t+"%",this.params.op["shop.city"]="LIKE"):this.drawerData.sameCity.choice?(this.params.filter["shop.city"]=this.drawerData.sameCity.name,this.params.op["shop.city"]="LIKE"):(delete this.params.filter["shop.city"],delete this.params.op["shop.city"]);var a="";this.drawerData.brand.forEach((function(t){t.choice&&(a=t.id)})),a?(this.params.filter.brand_id=a,this.params.op.brand_id="="):(delete this.params.filter.brand_id,delete this.params.op.brand_id);var e=[];this.drawerData.attribute.forEach((function(t,a){t.value.forEach((function(t,a){t.choice&&e.push("%"+t.name+"%")}))})),e.length>0?(this.params.filter.category_attribute=e.join(","),this.params.op.category_attribute="LIKE"):(delete this.params.filter.category_attribute,delete this.params.op.category_attribute),this.status="loading",this.goodsData=[],this.params.page=1,this.reload=!0,this.loadData(),this.closeDrawer()},onDrawerReset:function(){this.drawerData.city.forEach((function(t){t.choice=!1})),this.drawerData.sameCity.choice=!1,this.loadDrawer()},onDraverTitle:function(t){var a=t.currentTarget.dataset.key;"city"===a?this.drawerType[a]=!this.drawerType[a]:this.drawerData.attribute[a].fold=!this.drawerData.attribute[a].fold},closeDrawer:function(){this.showRight=!1},search:function(){this.$flbooth.to("/pages/page/search?type=".concat(this.goodsType),"fade-in",100)},editListstyle:function(){this.liststyle="col-1-10"==this.liststyle?"col-2-20":"col-1-10"}}};a.default=n}).call(this,e("543d")["default"])},"7f74":function(t,a,e){"use strict";e.d(a,"b",(function(){return i})),e.d(a,"c",(function(){return o})),e.d(a,"a",(function(){return r}));var r={wanlProduct:function(){return e.e("components/wanl-product/wanl-product").then(e.bind(null,"8121"))},wanlEmpty:function(){return e.e("components/wanl-empty/wanl-empty").then(e.bind(null,"e5e5"))},wanlDivider:function(){return e.e("components/wanl-divider/wanl-divider").then(e.bind(null,"8953"))},uniLoadMore:function(){return e.e("components/uni-load-more/uni-load-more").then(e.bind(null,"1e1f"))},uniDrawer:function(){return e.e("components/uni-drawer/uni-drawer").then(e.bind(null,"2b23"))}},i=function(){var t=this,a=t.$createElement,e=(t._self._c,t.$flbooth.wanlsys()),r=t.$flbooth.wanlsys(),i=t.$flbooth.wanlsys(),o=t.$flbooth.wanlsys();t._isMounted||(t.e0=function(a){return t.$flbooth.back(1)}),t.$mp.data=Object.assign({},{$root:{g0:e,g1:r,g2:i,g3:o}})},o=[]},b855:function(t,a,e){"use strict";var r=e("106b"),i=e.n(r);i.a},db13:function(t,a,e){"use strict";e.r(a);var r=e("7f74"),i=e("4f13");for(var o in i)"default"!==o&&function(t){e.d(a,t,(function(){return i[t]}))}(o);e("b855");var c,n=e("f0c5"),s=Object(n["a"])(i["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],c);a["default"]=s.exports}},[["077f","common/runtime","common/vendor"]]]);