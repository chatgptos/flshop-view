(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product/goods"],{"0815":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(o("a34a")),i=o("26cb");function s(t){return t&&t.__esModule?t:{default:t}}function r(t){return u(t)||c(t)||d(t)||a()}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function u(t){if(Array.isArray(t))return p(t)}function l(t,e){var o;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=d(t))||e&&t&&"number"===typeof t.length){o&&(t=o);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){o=t[Symbol.iterator]()},n:function(){var t=o.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==o.return||o.return()}finally{if(a)throw s}}}}function d(t,e){if(t){if("string"===typeof t)return p(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}function h(t,e,o,n,i,s,r){try{var a=t[s](r),c=a.value}catch(u){return void o(u)}a.done?e(c):Promise.resolve(c).then(n,i)}function f(t){return function(){var e=this,o=arguments;return new Promise((function(n,i){var s=t.apply(e,o);function r(t){h(s,n,i,r,a,"next",t)}function a(t){h(s,n,i,r,a,"throw",t)}r(void 0)}))}}function m(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function g(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?m(Object(o),!0).forEach((function(e){b(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):m(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function b(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var _={data:function(){return{TabCur:0,wanlsys:{},modalName:null,durect:0,headerOpacity:0,currentSwiper:0,anchorlist:[{name:"主图",top:0},{name:"评价",top:0},{name:"详情",top:0},{name:"推荐",top:0}],selectAnchor:0,goodsData:{id:0,category_id:0,shop_id:0,brand_id:0,freight_id:0,title:"",image:"",images:"",flag:"",content:"",category_attribute:[],activity_type:"goods",price:null,interval_price:null,market_price:null,sales:0,brand:{},freight:{name:"",isdelivery:1},payment:0,comment:0,praise:0,moderate:0,negative:0,like:0,views:0,status:"",category:{},follow:!0,sku:[],spu:[],promotion:[],coupon:[],comment_list:{data:[],figure:0,tag:[]},shop:{find_user:{fans:0},city:""},shop_recommend:{}},reload:!0,likeData:[],current_page:1,last_page:1,status:"loading",contentText:{contentdown:" ",contentrefresh:"正在加载...",contentnomore:"没有更多数据了"},shopItemInfo:{},selectArr:[],subIndex:[],selectshop:{},selectNum:1,isChoice:"",scrollAnimation:100}},onLoad:function(t){this.wanlsys=this.$flbooth.wanlsys(),this.loadData(t),this.loadlikeData(),wx.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]}),this.durect=this.$store.state.statistics.notice.notice+this.$store.state.statistics.notice.order+this.$store.state.statistics.notice.chat+this.$store.state.statistics.order.pay+this.$store.state.statistics.order.delive+this.$store.state.statistics.order.receiving+this.$store.state.statistics.order.evaluate},onPageScroll:function(t){var e=150;t.scrollTop=t.scrollTop>e?150:t.scrollTop,this.headerOpacity=t.scrollTop*(1/e)},onReachBottom:function(){this.current_page>=this.last_page?this.status="noMore":(this.reload=!1,this.current_page=this.current_page+1,this.status="loading",this.loadlikeData())},watch:{selectshop:function(t,e){t.price!=e.price&&this.queryCoupon(t.price)}},computed:g({canCount:function(){return this.subIndex.some((function(t){return-1===t}))}},(0,i.mapState)(["cart","common"])),methods:{loadData:function(t){var e=this;return f(n.default.mark((function o(){return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:e.$api.get({url:"/flbooth/product/goods",data:t,success:function(t){if(t.content=t.content.replace(/<img [^>]*src=['"]([^'"]+)[^>]*>/gi,(function(t,o){var n='<img style="display: block; max-width: 100%;" src="'.concat(e.$flbooth.oss(o,500,0),'">');return n})),0==t.sku.length)t.interval_price=t.price,t.market_price=t.price;else{var o,n=[],i=[],s=l(t.sku);try{for(s.s();!(o=s.n()).done;){var r=o.value;n.push(r.price),i.push(r.market_price)}}catch(d){s.e(d)}finally{s.f()}var a=Math.min.apply(null,n),c=Math.max.apply(null,n),u=Math.max.apply(null,i);t.interval_price=a==c?Number(a).toFixed(2):a+"-"+Number(c).toFixed(2),t.market_price=Number(u).toFixed(2)}e.goodsData=t,e.goodsData.spu.map((function(t){t.item.map((function(t,o,n){n[o].name=e.$base64.encode(n[o].name)})),e.selectArr.push(""),e.subIndex.push(-1)})),e.goodsData.sku.map((function(t){t.difference.map((function(t,o,n){n[o]=e.$base64.encode(t)}))})),e.checkItem(),e.checkInpath(-1),setTimeout((function(){e.calcAnchor()}),1e3)}});case 1:case"end":return o.stop()}}),o)})))()},loadlikeData:function(){var t=this;return f(n.default.mark((function e(){return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$api.get({url:"/flbooth/product/likes?pages=goods",data:{page:t.current_page},success:function(e){t.likeData=t.reload?e.data:t.likeData.concat(e.data),t.current_page=e.current_page,t.last_page=e.last_page,t.status="more"}});case 1:case"end":return e.stop()}}),e)})))()},queryCoupon:function(t){var e=this;return f(n.default.mark((function o(){return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:e.$api.post({url:"/flbooth/coupon/query",data:{shop_id:e.goodsData.shop_id,goods_id:e.goodsData.id,shop_category_id:e.goodsData.shop_category_id,price:t},success:function(t){e.goodsData.coupon=t}});case 1:case"end":return o.stop()}}),o)})))()},onReceive:function(t){var e=this;return f(n.default.mark((function o(){var i;return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:i=e.goodsData.coupon[t],e.$api.post({url:"/flbooth/coupon/receive",loadingTip:"领取中",data:{id:i.id},success:function(t){i.id=t.id,i.state=!0,e.$flbooth.msg(t.msg),e.$store.commit("statistics/dynamic",{coupon:e.$store.state.statistics.dynamic.coupon+1})}});case 2:case"end":return o.stop()}}),o)})))()},loadStock:function(t){var e=this;return f(n.default.mark((function o(){return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:e.$api.get({url:"/flbooth/product/stock",data:{sku_id:t},success:function(t){e.selectshop.stock=t}});case 1:case"end":return o.stop()}}),o)})))()},skuClick:function(t,e,o,n){var i=this;t.ishow&&(this.selectArr[e]!=t.name?(this.$set(this.selectArr,e,t.name),this.$set(this.subIndex,e,n)):(this.$set(this.selectArr,e,""),this.$set(this.subIndex,e,-1)),this.checkInpath(e),this.selectArr.every((function(t){return""!=t}))&&(this.selectshop=this.shopItemInfo[this.selectArr],this.selectshop.difference.map((function(t,e,o){o[e]=i.$base64.decode(t)})),this.loadStock(this.selectshop.id),this.selectNum=1))},checkInpath:function(t){for(var e=0,o=this.goodsData.spu.length;e<o;e++)if(e!=t)for(var n=this.goodsData.spu[e].item.length,i=0;i<n;i++)if(-1==this.subIndex[e]||i!=this.subIndex[e]){var s=r(this.selectArr);this.$set(s,e,this.goodsData.spu[e].item[i].name);var a=s.filter((function(t){return""!==t&&"undefined"!==typeof t}));this.shopItemInfo.hasOwnProperty(a)?this.$set(this.goodsData.spu[e].item[i],"ishow",!0):this.$set(this.goodsData.spu[e].item[i],"ishow",!1)}},checkItem:function(){var t=this;this.goodsData.sku.reduce((function(e,o){return e.concat(o.difference.reduce((function(e,n){return e.concat(e.map((function(e){return t.shopItemInfo.hasOwnProperty([].concat(r(e),[n]))||(t.shopItemInfo[[].concat(r(e),[n])]=o),[].concat(r(e),[n])})))}),[[]]))}),[[]])},changeNum:function(t){if(this.selectshop.stock){var e=parseInt(t);e>this.selectshop.stock?(this.$flbooth.msg("数量不能超过库存 ".concat(this.selectshop.stock," 件")),this.selectNum=parseInt(this.selectshop.stock)):this.selectNum=parseInt(t)}},swiperChange:function(t){this.currentSwiper=t.detail.current},showModal:function(t){var e=this;this.isChoice="","share"==t&&"share"!=this.modalName&&setTimeout((function(){e.scrollAnimation=0}),300),this.modalName=t},hideModal:function(t){t?this.showModal(t):this.modalName=null},wanlShare:function(t){t?this.$flbooth.auth("/pages/user/complaint/complaint?id=".concat(this.goodsData.id,"&type=1")):this.modalName=null},moveHandle:function(){},follow:function(){var t=this;this.goodsData.follow=!this.goodsData.follow,this.goodsData.follow?this.$store.commit("statistics/dynamic",{collection:this.$store.state.statistics.dynamic.collection+1}):this.$store.commit("statistics/dynamic",{collection:this.$store.state.statistics.dynamic.collection-1}),this.$api.post({url:"/flbooth/product/follow",data:{id:this.goodsData.id},success:function(e){t.goodsData.follow=e}})},toAnchor:function(e){this.selectAnchor=e,t.pageScrollTo({scrollTop:this.anchorlist[e].top,duration:200})},calcAnchor:function(){var e=this,o=null;o=t.createSelectorQuery().in(this),o.select("#evaluate").boundingClientRect((function(t){e.anchorlist[1].top=t.top-e.wanlsys.height-45})).exec(),o.select("#details").boundingClientRect((function(t){e.anchorlist[2].top=t.top-e.wanlsys.height-45})).exec(),o.select("#recommend").boundingClientRect((function(t){e.anchorlist[3].top=t.top-e.wanlsys.height-45})).exec()},onTag:function(t){this.$flbooth.to("/pages/product/comment?id="+this.goodsData.id+"&praise="+this.goodsData.praise+"&tag="+t)},toCart:function(){t.switchTab({url:"/pages/cart"})},completeSelection:function(){this.canCount?this.$flbooth.msg("请选择完成规格"):this.ProcessingData()},SubmitData:function(t,e){1==e?this.canCount?this.$flbooth.msg("请选择完成规格"):(this.isChoice=t,this.ProcessingData()):(this.modalName="option",this.isChoice=t)},ProcessingData:function(){if("addToCart"==this.isChoice)this.$store.dispatch("cart/add",{shop_id:this.goodsData.shop_id,shop_name:this.goodsData.shop.shopname,goods_id:this.goodsData.id,title:this.goodsData.title,number:this.selectNum,image:this.goodsData.image,sku:this.selectshop,sku_id:this.selectshop.id,sum:this.$flbooth.bcmul(this.selectshop.price,this.selectNum)}),this.$flbooth.msg("已加购物车");else if("placeOrder"==this.isChoice){var e=[{goods_id:this.goodsData.id,number:this.selectNum,sku_id:this.selectshop.id}];this.$store.state.user.isLogin?t.redirectTo({url:"/pages/user/order/addorder?order_type=groups&data=".concat(JSON.stringify(e))}):this.$flbooth.to("/pages/user/auth/auth")}else this.$flbooth.msg("数据异常");this.hideModal()},productSearch:function(t){this.$flbooth.to("/pages/page/search?type=goods&keywords=".concat(t),"fade-in",100)}}};e.default=_}).call(this,o("543d")["default"])},5307:function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return s})),o.d(e,"a",(function(){return n}));var n={wanlRate:function(){return o.e("components/wanl-rate/wanl-rate").then(o.bind(null,"3ca7"))},wanlDivider:function(){return o.e("components/wanl-divider/wanl-divider").then(o.bind(null,"8953"))},wanlProduct:function(){return o.e("components/wanl-product/wanl-product").then(o.bind(null,"8121"))},uniLoadMore:function(){return o.e("components/uni-load-more/uni-load-more").then(o.bind(null,"1e1f"))},wanlDirect:function(){return o.e("components/wanl-direct/wanl-direct").then(o.bind(null,"c414"))},wanlShare:function(){return Promise.all([o.e("common/vendor"),o.e("components/wanl-share/wanl-share")]).then(o.bind(null,"3b89"))},uniNumberBox:function(){return o.e("components/uni-number-box/uni-number-box").then(o.bind(null,"71cd"))}},i=function(){var t=this,e=t.$createElement,o=(t._self._c,t.__map(t.goodsData.images,(function(e,o){var n=t.__get_orig(e),i=t.$flbooth.oss(e,400,0);return{$orig:n,g0:i}}))),n=t.goodsData.shop.city?t.goodsData.shop.city.split("/"):null,i=0!=t.goodsData.coupon.length?t.__map(t.goodsData.coupon,(function(e,o){var n=t.__get_orig(e),i=o<2&&("reduction"==e.type||"vip"==e.type&&"reduction"==e.usertype)?Number(e.price):null,s=o<2&&("reduction"==e.type||"vip"==e.type&&"reduction"==e.usertype)?Number(e.limit):null,r=o<2&&("reduction"==e.type||"vip"==e.type&&"reduction"==e.usertype)?Number(e.price):null,a=o<2&&("discount"==e.type||"vip"==e.type&&"discount"==e.usertype)?Number(e.discount):null,c=o<2&&("discount"==e.type||"vip"==e.type&&"discount"==e.usertype)?Number(e.limit):null,u=o<2&&("discount"==e.type||"vip"==e.type&&"discount"==e.usertype)?Number(e.discount):null,l=o<2&&"shipping"==e.type?Number(e.limit):null;return{$orig:n,m0:i,m1:s,m2:r,m3:a,m4:c,m5:u,m6:l}})):null,s=t.canCount?null:t.__map(t.selectArr,(function(e,o){var n=t.__get_orig(e),i=t.$base64.decode(e);return{$orig:n,g2:i}})),r=t.__map(t.goodsData.spu,(function(e,o){var n=t.__get_orig(e),i=t.__map(e.item,(function(e,n){var i=t.__get_orig(e),s=0==o?t.$base64.decode(e.name):null;return{$orig:i,g3:s}}));return{$orig:n,l3:i}})),a=t.goodsData.comment>0?parseInt(t.goodsData.praise/t.goodsData.comment*100):null,c=t.__map(t.goodsData.comment_list.data,(function(e,o){var n=t.__get_orig(e),i=t.$flbooth.oss(e.user.avatar,26,26,2,"avatar"),s=0!=e.images.length?t.__map(e.images,(function(e,o){var n=t.__get_orig(e),i=o<=3?t.$flbooth.oss(e,88,88):null;return{$orig:n,g5:i}})):null;return{$orig:n,g4:i,l5:s}})),u=t.$flbooth.oss(t.goodsData.shop.avatar,52,52,2,"avatar"),l=t.$flbooth.toFormat(t.goodsData.shop.find_user.fans,"thousand"),d=t.__map(t.goodsData.shop_recommend,(function(e,o){var n=t.__get_orig(e),i=t.$flbooth.oss(e.image,125,120);return{$orig:n,g8:i}})),p=t.$flbooth.appstc("/coupon/bg_coupon_3x.png"),h=t.__map(t.goodsData.coupon,(function(e,o){var n=t.__get_orig(e),i=e.state?t.$flbooth.appstc("/coupon/img_couponcentre_received_3x.png"):null,s="reduction"==e.type||"vip"==e.type&&"reduction"==e.usertype?Number(e.price):null,r="reduction"==e.type||"vip"==e.type&&"reduction"==e.usertype?Number(e.limit):null,a="reduction"==e.type||"vip"==e.type&&"reduction"==e.usertype?Number(e.price):null,c="discount"==e.type||"vip"==e.type&&"discount"==e.usertype?Number(e.discount):null,u="discount"==e.type||"vip"==e.type&&"discount"==e.usertype?Number(e.limit):null,l="discount"==e.type||"vip"==e.type&&"discount"==e.usertype?Number(e.discount):null,d="shipping"==e.type?Number(e.limit):null;return{$orig:n,g10:i,m8:s,m9:r,m10:a,m11:c,m12:u,m13:l,m14:d}})),f=t.$flbooth.oss(t.goodsData.image,50,50),m=t.$flbooth.oss(t.selectshop.thumbnail||t.goodsData.image,100,100),g=t.selectArr.join(""),b=t.selectArr.join(""),_=b?t.__map(t.selectArr,(function(e,o){var n=t.__get_orig(e),i=t.$base64.decode(e);return{$orig:n,g15:i}})):null,y=b?null:t.__map(t.goodsData.spu,(function(e,o){var n=t.__get_orig(e),i=t.$base64.decode(e.name);return{$orig:n,g16:i}})),v=t.__map(t.goodsData.spu,(function(e,o){var n=t.__get_orig(e),i=t.__map(e.item,(function(e,o){var n=t.__get_orig(e),i=t.$base64.decode(e.name);return{$orig:n,g17:i}}));return{$orig:n,l11:i}}));t._isMounted||(t.e0=function(e){return t.$flbooth.back(1)}),t.$mp.data=Object.assign({},{$root:{l0:o,g1:n,l1:i,l2:s,l4:r,m7:a,l6:c,g6:u,g7:l,l7:d,g9:p,l8:h,g11:f,g12:m,g13:g,g14:b,l9:_,l10:y,l12:v}})},s=[]},"53d5":function(t,e,o){},"61db":function(t,e,o){"use strict";o.r(e);var n=o("5307"),i=o("c08b");for(var s in i)"default"!==s&&function(t){o.d(e,t,(function(){return i[t]}))}(s);o("97df");var r,a=o("f0c5"),c=Object(a["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);e["default"]=c.exports},"97df":function(t,e,o){"use strict";var n=o("53d5"),i=o.n(n);i.a},c08b:function(t,e,o){"use strict";o.r(e);var n=o("0815"),i=o.n(n);for(var s in n)"default"!==s&&function(t){o.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},d23c:function(t,e,o){"use strict";(function(t){o("e954");n(o("66fd"));var e=n(o("61db"));function n(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=o,t(e.default)}).call(this,o("543d")["createPage"])}},[["d23c","common/runtime","common/vendor"]]]);