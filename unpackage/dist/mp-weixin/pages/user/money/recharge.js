(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/money/recharge"],{"09f5":function(e,t,n){"use strict";n.r(t);var o=n("4285"),a=n("abd0");for(var s in a)"default"!==s&&function(e){n.d(t,e,(function(){return a[e]}))}(s);n("b1b1");var c,i=n("f0c5"),u=Object(i["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],c);t["default"]=u.exports},4285:function(e,t,n){"use strict";var o;n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o}));var a=function(){var e=this,t=e.$createElement;e._self._c},s=[]},"9fa4":function(e,t,n){"use strict";(function(e){n("e954");o(n("66fd"));var t=o(n("09f5"));function o(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},a13c:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("a34a"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n,o,a,s,c){try{var i=e[s](c),u=i.value}catch(r){return void n(r)}i.done?t(u):Promise.resolve(u).then(o,a)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var c=e.apply(t,n);function i(e){s(c,o,a,i,u,"next",e)}function u(e){s(c,o,a,i,u,"throw",e)}i(void 0)}))}}var i={data:function(){return{loading:!1,disabled:!1,money:null,payList:[]}},onLoad:function(){var t=this,n="wap";n="miniapp",e.getProvider({service:"payment",success:function(e){e.provider.map((function(e){"alipay"==e?t.payList.push({name:"支付宝",describe:"",type:e,method:n,state:!0,select:!1}):"wxpay"==e?t.payList.push({name:"微信支付",describe:"推荐使用微信支付",type:"wechat",method:n,state:!0,select:!1}):"baidu"==e?t.payList.push({name:"百度收银台",describe:"",type:e,method:n,state:!0,select:!1}):"appleiap"==e&&t.payList.push({name:"Apple支付",describe:"",type:"apple",method:n,state:!0,select:!1})}))}})},methods:{confirm:function(){var t=this,n=null;this.disabled||(this.money<=0?this.$flbooth.msg("请输入充值金额"):(this.payList.map((function(e,t,o){e.select&&(n=e)})),n?(this.loading=!0,this.disabled=!0,e.login({success:function(e){t.wanlPay(n,e.code)},fail:function(t){e.showModal({content:"无法获取微信code,原因为: "+t.errMsg,showCancel:!1})}})):this.$flbooth.msg("请选择支付方式")))},wanlPay:function(t){var n=arguments,a=this;return c(o.default.mark((function s(){var c;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:c=n.length>1&&void 0!==n[1]?n[1]:null,a.$api.post({url:"/flbooth/pay/recharge",data:{type:t.type,method:t.method,code:c,money:a.money},success:function(n){switch(t.type){case"wechat":"wap"==t.method?(a.loading=!1,e.showModal({title:"微信支付",content:"是否已完成支付",success:function(e){e.confirm?a.paySuccess():e.cancel&&console.log("用户点击取消")}}),window.location.href=n):"app"==t.method?e.requestPayment({provider:"wxpay",orderInfo:n,success:function(e){a.paySuccess()},fail:function(t){e.showModal({content:"支付失败,原因为: "+t.errMsg,showCancel:!1})},complete:function(){a.loading=!1,a.disabled=!1}}):"miniapp"==t.method?e.requestPayment({appId:n.appId,nonceStr:n.nonceStr,package:n.package,paySign:n.paySign,signType:n.signType,timeStamp:n.timeStamp,success:function(e){a.paySuccess()},fail:function(t){e.showModal({content:"支付失败,原因为: "+t.errMsg,showCancel:!1})},complete:function(){a.loading=!1,a.disabled=!1}}):"mp"==t.method&&a.$jssdk.wxpay({data:n,success:function(e){a.paySuccess()},fail:function(e){"chooseWXPay:ok"==e.errMsg?a.$flbooth.msg("支付成功"):"chooseWXPay:cancel"==e.errMsg?a.$flbooth.msg("支付失败，取消支付"):"chooseWXPay:fail"==e.errMsg&&a.$flbooth.msg("支付失败")}});break;case"alipay":"wap"==t.method?(a.loading=!1,document.write(n)):"app"==t.method&&e.requestPayment({provider:"alipay",orderInfo:n,success:function(e){a.paySuccess()},fail:function(t){e.showModal({content:"支付失败,原因为: "+t.errMsg,showCancel:!1})},complete:function(){a.loading=!1,a.disabled=!1}});break}}});case 2:case"end":return o.stop()}}),s)})))()},onSelect:function(e){this.payList.map((function(t,n,o){t.select=n==e&&!t.select}))},emptyInput:function(){this.money=null},paySuccess:function(){this.loading=!1,this.$store.commit("user/setUserInfo",{money:this.$flbooth.bcadd(this.$store.state.user.money,this.money)}),this.$flbooth.to("/pages/page/success?type=recharge")}}};t.default=i}).call(this,n("543d")["default"])},abd0:function(e,t,n){"use strict";n.r(t);var o=n("a13c"),a=n.n(o);for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);t["default"]=a.a},b1b1:function(e,t,n){"use strict";var o=n("cb0d"),a=n.n(o);a.a},cb0d:function(e,t,n){}},[["9fa4","common/runtime","common/vendor"]]]);